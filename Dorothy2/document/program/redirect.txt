redirect.dms


各種 URL 転送サイト用のスクリプトです。

Irvine のフィルタリング機能を転送先 URL に適用させるため、新しいアイテム
を追加して転送元のアイテムは削除します。

以下のいずれにも該当しない場合は使う意味はありません。
・Irvine のフィルタリング機能を転送先の URL に適用させたい場合
・p.tl など、302 以外の方法で転送するサイトを処理したい場合
  (302 で転送するサイトは Irvine 自体で処理できるのでスクリプト不要)

他のスクリプトが期待通りに動かない場合はこのスクリプトを無効にして原因
の切り分けを行なって下さい。


使用方法
========

設定ファイルには対応していないので、動作のカスタマイズは直接スクリプト
ファイルを書き換える必要があります。

1) redirect.dms の編集

redirect.dms をテキストエディタで開きます。

ファイル先頭近くにある
    Site: {
から
    }
の間でサイト毎の有効(true)、無効(false)を切り替えることができます。

編集完了したらファイルを保存します。

2) //match= の更新

以下の手順で設定ダイアログを開きます。
  ツール → メインメニュー → 動画ダウンロード設定２
  プログラムを右クリック → 設定

「//match= 更新」ボタンをクリックします。

「OK」ボタンで設定ダイアログを閉じます。

3) Dorothy2 のデータの更新

動画ダウンロード設定２の画面で編集 → データを再読込みを実行してから
保存します。


動作について
============

転送先 URL を新しいアイテムとして Irvine に追加し、実行中のアイテムは
ダミー URL をダウンロードして自動削除します。

設定を ReQueue=false に変更すると元のアイテムのまま処理を続行します。
(転送先が複数の場合は常にアイテムを追加します)

以下のドキュメントも参照して下さい。

・アイテム追加
  Dorothy2\document\common\additem.txt


対応 URL
========

http://[0-9a-zA-Z]+.linkbucks.com/  ほか linkbucks 系サイト
http://adf.ly/
http://bit.ly/
http://extlink.blogsys.jp/
http://fc2.in/
http://goo.gl/
http://ime.nu/
http://j.mp/
http://jbbs.livedoor.jp/
http://lix.in/
http://ow.ly/
http://p.tl/
http://pinktower.com/
https?://t.co/
http://tinyurl.com/
http://tobeto.be/
http://wk.tk/
http://ws1.y-bbs.net/


仕様・制限事項
==============

・フォルダ設定 → HTTP(1) → HTTP メソッドを GET に設定する必要があります。


変更履歴
========

2014-07-29  version 20140729.0  rentan at rentan.org
  script Mode 引数で動作モードを切り替えるようにした。

2014-07-16  version 20140716.0  rentan at rentan.org
  linkbucks 系の仕様変更に対応。
    thanks to http://peace.2ch.net/test/read.cgi/win/1394240473/542

2014-06-11  version 20140611.0  rentan at rentan.org
  rutil で User-Agent のチェックを強化したのに伴い、linkbucks 系の
  User-Agent 差し替え機能を削除。

2014-05-21  version 20140521.0  rentan at rentan.org
  linkbucks 系で User-Agent が Mozilla/4.* の場合は Mozilla/5.0
  の User-Agent に差し替えるようにした(403 Forbidden 対策)。

  doaConstructor(): DOA_item_add() を使わずに Dorothy2R DOA の
  拡張機能にまかせるようにした(Dorothy2 純正の DOA では動作しない)。

2014-05-12  version 20140512.0  rentan at rentan.org
  freegaysitepass.com に対応。

2014-03-31  version 20140331.0  rentan at rentan.org
  GNU GPL v3 or later を適用。
  このファイルを UTF-8 に変更。

  redirect.set で common\EZDialog.dms を使わないようにした。

  linkbucks 系で loadTargetUrl 形式に対応。

2014-01-24
  linkbucks 系でサブドメイン形式からサブディレクトリ形式への転送
  を挟むケースに対応。

  wk.tk に対応。
  zpag.es を削除。

2013-11-29
  内部構造を変更し、主要機能を UrlRedirector オブジェクトとして
  独立化。複数 URL への転送に対応。

  lix.in に対応。

2013-08-19
  adf.ly の難読化形式に対応。
    thanks to http://toro.2ch.net/test/read.cgi/win/1371715233/57

2013-07-13
  ow.ly の転送 URL 以外を無視するようにした。
  adf.ly の暗号・難読化された形式をエラーにするようにした。

2013-06-18
  linkbucks の別ドメインに対応。
    thanks to http://toro.2ch.net/test/read.cgi/win/1348568425/927

  adf.ly の var zzz= 形式に対応。
    thanks to http://toro.2ch.net/test/read.cgi/win/1348568425/950

  サイトの有効無効をスクリプト冒頭の default_ini.Site オブジェクトで
  切り替えられるようにした。

  ほかサイト側の仕様変更に対応など修正いろいろ。

2013-06-10
  https://t.co/ への対応が不完全だった不具合を修正。

2013-04-17
  https://t.co/ に対応(従来は http:// のみだった)。

2012-12-04
  ReQueue=true の時、アイテムにコメントが設定されていればそれを新しい
  アイテムに引き継ぐようにした(無い場合は従来通り元の URL を設定)。

  ws1.y-bbs.net を修正。

2012-11-19
  ソースコード整理のみ。

2012-08-02
  エラー時にダウンロードスレッドを終了するようにした。

2012-07-29
  adf.ly p.tl の仕様変更に対応。

2012-07-11
  common\{rutil,additem}.dms を使うようにした。

2012-03-29
  common\http.dms を使うようにした。

  設定プログラムを redirect.dms と rentan_pack.dms で共通化。
  バックアップを保存する場所を backup フォルダに変更。

  http://adf.ly/go/〜 のアドレスに対応。

2012-02-15
  tobeto.be を追加。

2012-01-24
  zpag.es でリロード前に待機時間を入れた。効果があるかは不明。

2012-01-20
  初期バージョン。


[EOF]
